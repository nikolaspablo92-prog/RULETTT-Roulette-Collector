<!DOCTYPE html>
<html lang="ru">
<head>`n    <link rel="stylesheet" href="extracted-styles.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>рџ©є RULETTT Debug</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI';
            background: #1a1a1a;
            color: #fff;
            margin: 0;
            padding: 20px;
        }
        .debug-box {
            background: #333;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 14px;
        }
        .success { border-left: 5px solid #4CAF50; }
        .error { border-left: 5px solid #f44336; }
        .warning { border-left: 5px solid #ff9800; }
        .info { border-left: 5px solid #2196f3; }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
    </style>
</head>
<body>
    <h1>рџ©є RULETTT Debug Panel</h1>
    <p>Р”РёР°РіРЅРѕСЃС‚РёРєР° СЃРёСЃС‚РµРјС‹ РґР»СЏ macOS РїРѕР»СЊР·РѕРІР°С‚РµР»РµР№</p>
    
    <button onclick="runAllTests()">рџ”Ќ Р—Р°РїСѓСЃС‚РёС‚СЊ РІСЃРµ С‚РµСЃС‚С‹</button>
    <button onclick="clearResults()">рџ§№ РћС‡РёСЃС‚РёС‚СЊ</button>
    
    <div id="results"></div>

    <script>
        const results = document.getElementById('results');
        
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `debug-box ${type}`;
            div.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            results.appendChild(div);
            console.log(`[${type.toUpperCase()}] ${message}`);
        }
        
        function clearResults() {
            results.innerHTML = '';
        }
        
        async function testBasics() {
            log('рџ”Ќ РўРµСЃС‚РёСЂСѓРµРј Р±Р°Р·РѕРІС‹Рµ С„СѓРЅРєС†РёРё...', 'info');
            
            // РџСЂРѕРІРµСЂСЏРµРј window.location
            log(`рџ“Ќ URL: ${window.location.href}`, 'info');
            log(`рџЊђ Host: ${window.location.hostname}`, 'info');
            log(`рџ”Њ Port: ${window.location.port}`, 'info');
            
            // РџСЂРѕРІРµСЂСЏРµРј User Agent  
            log(`рџ’» User Agent: ${navigator.userAgent}`, 'info');
            
            // РџСЂРѕРІРµСЂСЏРµРј РєРѕРЅСЃРѕР»СЊ
            console.log('рџљЂ Debug panel loaded - checking console');
            log('вњ… РљРѕРЅСЃРѕР»СЊ JavaScript СЂР°Р±РѕС‚Р°РµС‚', 'success');
        }
        
        async function testLocalAPI() {
            log('рџ”Њ РўРµСЃС‚РёСЂСѓРµРј Р»РѕРєР°Р»СЊРЅС‹Р№ API...', 'info');
            
            const currentHost = window.location.hostname;
            const apiUrl = `http://${currentHost}:5000/api/health`;
            
            log(`рџ“Ў API URL: ${apiUrl}`, 'info');
            
            try {
                const response = await fetch(apiUrl);
                log(`рџ“Љ HTTP Status: ${response.status}`, response.ok ? 'success' : 'error');
                
                if (response.ok) {
                    const data = await response.json();
                    log(`вњ… API Response: ${JSON.stringify(data)}`, 'success');
                } else {
                    log(`вќЊ API Error: ${response.statusText}`, 'error');
                }
            } catch (error) {
                log(`рџ’Ґ Fetch Error: ${error.message}`, 'error');
                log(`рџ”Ќ Error Type: ${error.constructor.name}`, 'error');
            }
        }
        
        async function testHardcodedAPI() {
            log('рџЋЇ РўРµСЃС‚РёСЂСѓРµРј С…Р°СЂРґРєРѕРґРёСЂРѕРІР°РЅРЅС‹Р№ API...', 'info');
            
            const hardcodedUrl = 'http://192.168.88.216:5000/api/health';
            log(`рџ“Ў Hardcoded URL: ${hardcodedUrl}`, 'info');
            
            try {
                const response = await fetch(hardcodedUrl);
                log(`рџ“Љ HTTP Status: ${response.status}`, response.ok ? 'success' : 'error');
                
                if (response.ok) {
                    const data = await response.json();
                    log(`вњ… Hardcoded API Response: ${JSON.stringify(data)}`, 'success');
                } else {
                    log(`вќЊ Hardcoded API Error: ${response.statusText}`, 'error');
                }
            } catch (error) {
                log(`рџ’Ґ Hardcoded Fetch Error: ${error.message}`, 'error');
                log(`рџ”Ќ CORS РёР»Рё Network Error?`, 'warning');
            }
        }
        
        async function testCORS() {
            log('рџЊђ РўРµСЃС‚РёСЂСѓРµРј CORS РЅР°СЃС‚СЂРѕР№РєРё...', 'info');
            
            try {
                const response = await fetch('http://192.168.88.216:5000/api/health', {
                    method: 'GET',
                    mode: 'cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                });
                
                log(`рџЋЇ CORS Headers Available:`, 'info');
                for (let [key, value] of response.headers.entries()) {
                    if (key.toLowerCase().includes('access-control')) {
                        log(`   ${key}: ${value}`, 'success');
                    }
                }
                
            } catch (error) {
                log(`рџ’Ґ CORS Test Failed: ${error.message}`, 'error');
            }
        }
        
        async function testAI() {
            log('рџ¤– РўРµСЃС‚РёСЂСѓРµРј AI С„СѓРЅРєС†РёРё...', 'info');
            
            try {
                const response = await fetch('http://192.168.88.216:5000/api/chat/ai', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        'message': 'С‚РµСЃС‚', 
                        'session_id': 'debug_test'
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    log(`рџ¤– AI Response: ${data.ai_response}`, 'success');
                } else {
                    log(`вќЊ AI Error: ${response.status}`, 'error');
                }
            } catch (error) {
                log(`рџ’Ґ AI Test Failed: ${error.message}`, 'error');
            }
        }
        
        async function runAllTests() {
            clearResults();
            log('рџљЂ РќР°С‡РёРЅР°РµРј РїРѕР»РЅСѓСЋ РґРёР°РіРЅРѕСЃС‚РёРєСѓ...', 'info');
            
            await testBasics();
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            await testLocalAPI();
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            await testHardcodedAPI(); 
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            await testCORS();
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            await testAI();
            
            log('вњ… Р”РёР°РіРЅРѕСЃС‚РёРєР° Р·Р°РІРµСЂС€РµРЅР°!', 'success');
        }
        
        // РђРІС‚РѕР·Р°РїСѓСЃРє С‡РµСЂРµР· 2 СЃРµРєСѓРЅРґС‹
        setTimeout(() => {
            log('рџ”„ РђРІС‚РѕР·Р°РїСѓСЃРє РґРёР°РіРЅРѕСЃС‚РёРєРё...', 'info');
            runAllTests();
        }, 2000);
        
        log('рџ©є Debug panel РіРѕС‚РѕРІ', 'success');
    </script>
</body>
</html>
