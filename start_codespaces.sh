#!/bin/bash

# ๐ฒ ะะะขะะะะะฃะกะ RULETTT ะ GITHUB CODESPACES
# ========================================

echo "๐ฒ ะะฐะฟััะบ ัะธััะตะผั RULETTT ะฒ Codespaces..."
echo "=========================================="

# ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน Python
echo "๐ฆ ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน Python..."
pip install flask flask-cors pandas aiohttp sqlite3 || true

# ะกะพะทะดะฐะฝะธะต ะฝะตะพะฑัะพะดะธะผัั ะฟะฐะฟะพะบ
echo "๐ ะกะพะทะดะฐะฝะธะต ััััะบัััั ะฟะฐะฟะพะบ..."
mkdir -p data exports webapp/icons

# ะัะพะฒะตัะบะฐ ััะพ ัะฐะนะปั ัััะตััะฒััั
if [ ! -f "api_server.py" ]; then
    echo "โ ะคะฐะนะป api_server.py ะฝะต ะฝะฐะนะดะตะฝ!"
    exit 1
fi

if [ ! -f "webapp/dashboard.html" ]; then
    echo "โ ะะตะฑ-ะธะฝัะตััะตะนัั ะฝะต ะฝะฐะนะดะตะฝั!"
    exit 1
fi

# ะะฐะฟััะบ API ัะตัะฒะตัะฐ ะฒ ัะพะฝะต
echo "๐ ะะฐะฟััะบ API ัะตัะฒะตัะฐ (ะฟะพัั 5000)..."
python api_server.py &
API_PID=$!

# ะะดะตะผ ะทะฐะฟััะบะฐ API
sleep 5

# ะะฐะฟััะบ ะฒะตะฑ-ัะตัะฒะตัะฐ ะดะปั ะธะฝัะตััะตะนัะพะฒ
echo "๐ ะะฐะฟััะบ ะฒะตะฑ-ัะตัะฒะตัะฐ (ะฟะพัั 8080)..."
cd webapp
python -m http.server 8080 &
WEB_PID=$!
cd ..

# ะะดะตะผ ะทะฐะฟััะบะฐ ะฒะตะฑ-ัะตัะฒะตัะฐ
sleep 3

echo ""
echo "โ RULETTT ััะฟะตัะฝะพ ะทะฐะฟััะตะฝ ะฒ Codespaces!"
echo "=========================================="
echo ""
echo "๐ ะะพัััะฟะฝัะต ะธะฝัะตััะตะนัั:"
echo "  - API Health: /api/health (ะฟะพัั 5000)"
echo "  - Dashboard: /dashboard.html (ะฟะพัั 8080)"
echo "  - Mobile: /mobile.html (ะฟะพัั 8080)"
echo "  - Analytics: /advanced_analytics.html (ะฟะพัั 8080)"
echo "  - Communication: /communication.html (ะฟะพัั 8080)"
echo ""
echo "๐ก VS Code ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะพะทะดะฐัั ะฟัะฑะปะธัะฝัะต ัััะปะบะธ ะดะปั ะฟะพััะพะฒ"
echo "๐ ะะฐะถะผะธัะต 'Make Public' ะบะพะณะดะฐ ะฟะพัะฒัััั ัะฒะตะดะพะผะปะตะฝะธั ะพ ะฟะพััะฐั"
echo ""
echo "๐ฏ ะะปั ะพััะฐะฝะพะฒะบะธ ัะตัะฒะธัะพะฒ ะธัะฟะพะปัะทัะนัะต:"
echo "  kill $API_PID  # ะััะฐะฝะพะฒะธัั API"
echo "  kill $WEB_PID  # ะััะฐะฝะพะฒะธัั ะฒะตะฑ-ัะตัะฒะตั"
echo ""

# ะกะพััะฐะฝัะตะผ PID ะฟัะพัะตััะพะฒ ะดะปั ะฒะพะทะผะพะถะฝะพััะธ ะพััะฐะฝะพะฒะบะธ
echo $API_PID > .api_pid
echo $WEB_PID > .web_pid

echo "๐ ะะพัะพะฒะพ! ะกะธััะตะผะฐ RULETTT ัะฐะฑะพัะฐะตั ะฒ Codespaces!"
echo "๐ ะะฝััััะบัะธั ะดะปั ััะฐััะฝะธะบะพะฒ ะบะพะผะฐะฝะดั ะฒ ัะฐะนะปะต TEAM_INVITATION.md"

# ะะตัะถะธะผ ัะบัะธะฟั ะฐะบัะธะฒะฝัะผ
wait